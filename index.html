<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SarkariSarthi Jobs</title>
  <style>
    body { font-family: sans-serif; background: #0d1117; color: #c9d1d9; padding: 20px; }
    .job { background: #161b22; border: 1px solid #30363d; padding: 15px; margin: 10px 0; border-radius: 8px; }
    .job h3 { margin: 0 0 5px; color: #58a6ff; }
    .filters { margin-bottom: 20px; }
    select, input[type="text"] { padding: 8px; margin-right: 10px; border-radius: 5px; border: none; }
    a { color: #58a6ff; text-decoration: none; }
  </style>
</head>
<body>
  <h1>📋 SarkariSarthi Jobs</h1>

  <div class="filters">
    <input type="text" id="search" placeholder="🔍 Search job titles..." />
    <select id="stateFilter"><option value="">All States</option></select>
    <select id="categoryFilter"><option value="">All Categories</option></select>
  </div>

  <div id="jobs">Loading jobs...</div>

  <script>
    const jobsFolder = "https://parya5103.github.io/sarkarisarthi/jobs/";
    const jobFiles = [
      "government-jobs.json",
      "railway-jobs.json",
      "ssc-chsl-recruitment-2025.json",
      "defence-jobs.json",
      "bank-jobs.json",
      "teaching-jobs.json"
      // 🔄 यहां और filenames जोड़ सकते हो
    ];

    const jobContainer = document.getElementById("jobs");
    const searchInput = document.getElementById("search");
    const stateFilter = document.getElementById("stateFilter");
    const categoryFilter = document.getElementById("categoryFilter");
    let allJobs = [];

    async function loadAllJobs() {
      allJobs = [];
      const promises = jobFiles.map(file =>
        fetch(jobsFolder + file)
          .then(r => r.ok ? r.json() : [])
          .catch(() => [])
      );
      const results = await Promise.all(promises);
      results.forEach(list => allJobs.push(...list));
      populateFilters(allJobs);
      applyFilters();
    }

    function populateFilters(jobs) {
      const states = [...new Set(jobs.map(j => j.state).filter(Boolean))].sort();
      const cats = [...new Set(jobs.map(j => j.department).filter(Boolean))].sort();

      states.forEach(s => stateFilter.innerHTML += `<option>${s}</option>`);
      cats.forEach(c => categoryFilter.innerHTML += `<option>${c}</option>`);
    }

    function applyFilters() {
      const q = searchInput.value.toLowerCase();
      const st = stateFilter.value;
      const cat = categoryFilter.value;

      const filtered = allJobs.filter(j => {
        const text = `${j.title} ${j.department} ${j.state}`.toLowerCase();
        return text.includes(q) && (!st || j.state === st) && (!cat || j.department === cat);
      });

      jobContainer.innerHTML = filtered.length
        ? filtered.map(j => `
          <div class="job">
            <h3>${j.title}</h3>
            <p><strong>Dept:</strong> ${j.department || 'N/A'}</p>
            <p><strong>State:</strong> ${j.state || 'All India'}</p>
            <p><strong>Last Date:</strong> ${j.last_date || 'N/A'}</p>
            ${j.pdf_link ? `<p><a href="${j.pdf_link}" target="_blank">📄 View PDF</a></p>` : ''}
            ${j.apply_link ? `<p><a href="${j.apply_link}" target="_blank">✅ Apply Link</a></p>` : ''}
          </div>`).join('')
        : `<p>No jobs found matching filters.</p>`;
    }

    searchInput.addEventListener("input", applyFilters);
    stateFilter.addEventListener("change", applyFilters);
    categoryFilter.addEventListener("change", applyFilters);

    loadAllJobs();
  </script>
</body>
</html>
